<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lexuefa.dao.user.UserDao">
    <select id="searchIdByOpenId" resultType="int">
        select id
        from user
        where open_id = #{openId}
    </select>
    
    <insert id="saveUser">
        insert into user
        <trim prefix="set" suffixOverrides=",">
            <if test="openId != null and openId != ''">
                open_id = #{openId},
            </if>
            <if test="loginReq.userName != null and loginReq.userName != ''">
                user_name = #{loginReq.userName},
            </if>
            <if test="loginReq.password != null and loginReq.password != ''">
                password = #{loginReq.password},
            </if>
            <if test="loginReq.nickName != null and loginReq.nickName != ''">
                nick_name = #{loginReq.nickName},
            </if>
            <if test="loginReq.avatarUrl != null and loginReq.avatarUrl != ''">
                avatar_url = #{loginReq.avatarUrl},
            </if>
            <if test="loginReq.registerType != null and loginReq.registerType != ''">
                register_type = #{loginReq.registerType},
            </if>
            <if test="salt != null and salt != ''">
                salt = #{salt},
            </if>
        </trim>
    </insert>
    
    <select id="searchIdByUserName" resultType="int">
        select id
        from user
        where user_name = #{userName}
    </select>
    
</mapper>